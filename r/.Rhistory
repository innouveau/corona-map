source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/functions.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/functions.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/functions.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
get_annotation_1 <- function(settings) {
if (settings$type == 'main') {
text <- "• %s+ positieve tests"
text_merged <- sprintf(text, get_daily_reported_rounded(DATA.ready))
} else {
text <- "• %s% groei"
text_merged <- sprintf(text, get_change(DATA.ready))
}
return (text_merged)
}
get_annotation_2 <- function(settings) {
if (settings$type == 'main') {
text <- "• %s overleden"
text_merged <- sprintf(text, get_daily_deceased(DATA.ready))
} else {
text_merged <- "Text 2"
}
return (text_merged)
}
get_annotation_3 <- function(settings) {
if (settings$type == 'main') {
text <- "• besmettingsgraad: %s"
text_merged <- sprintf(text, get_infection_rate(DATA.ready))
} else {
text_merged <- "Text 3"
}
return (text_merged)
}
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
get_annotation_1(change_settings)
test <- get_annotation_1(change_settings)
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/functions.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/data-getters.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/data-getters.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/data-getters.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/data-getters.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
library(jsonlite)
library(geojsonio)
library(sp)
library(ggplot2)
library(broom)
library(sysfonts)
library(showtext)
library(dplyr)
library(rtweet)
project_path <- "/Users/jeroen/Documents/_work/innouveau/projects/innouveau/corona-map/dev/r"
source(paste0(project_path, "/src/variables.R"))
source(paste0(project_path, "/src/environment.R"))
source(paste0(project_path, "/src/fonts.R"))
source(paste0(project_path, "/src/data/data-getters.R"))
source(paste0(project_path, "/src/map/variables.R"))
source(paste0(project_path, "/src/map/plot.R"))
source(paste0(project_path, "/src/texts/functions.R"))
source(paste0(project_path, "/src/twitter/functions.R"))
source(paste0(project_path, "/src/twitter/credentials.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-1.R"))
source(paste0(project_path, "/src/twitter/tweets/tweet-2.R"))
# pick data (today, thisweek and previousweek) from source
DATA.deceased_today <- get_data_for_date(DATA.cases, today, "Deceased")
DATA.today <- get_data_for_date(DATA.cases, today, "Total_reported")
colnames(DATA.today)[2] <- 'Total_reported_today'
DATA.thisweek <- get_range(DATA.cases, today, 0, 6, "Total_reported", "Total_reported_this_week")
DATA.previousweek <- get_range(DATA.cases, today, 7, 13, "Total_reported", "Total_reported_last_week")
DATA.ready <- merge_data(DATA.municipalities, DATA.today, DATA.thisweek, DATA.previousweek, DATA.deceased_today)
# prepare data for plotting
MUNICIPALITIES.geo <- geojson_read(MUNICIPALITIES.geo.url,  what = "sp")
# join geo data with test data
MUNICIPALITIES.geo@data <- MUNICIPALITIES.geo@data %>%
left_join(DATA.ready,by=c("statcode"))
DATA.fortified <- fortify(MUNICIPALITIES.geo, region = "id")
DATA.merged <- merge(DATA.fortified, MUNICIPALITIES.geo@data, by = "id")
colnames(DATA.merged)[ncol(DATA.merged)] <- "Positieve tests per 100.000 inw. per 7 dagen"
# plot_map(DATA.merged, "main")
change_settings <- list(
type = "change",
filename = "change",
title = "Corona groei/krimp",
subtitle = format(Sys.time(), "%A %d %B")
)
plot_map(DATA.merged, change_settings)
if (MODUS.tweet) {
post_tweet(
status = get_tweet_1(),
media = paste0(project_path, "/plots/main.png")
)
post_tweet(
status = get_tweet_2(),
in_reply_to_status_id = get_last_tweet_id()
)
}
